---
import Layout from "@layouts/Layout.astro";
import Main from "@layouts/Main.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import Card from "@components/Card";
import { SITE } from "@config";

// Import from the correct path
import projectsData from "../content/data/projects.json";

// Get the actual array
const projects = Array.isArray(projectsData) ? projectsData : (projectsData.default || []);

// Reverse the array so last project in JSON appears first
const sortedProjects = [...projects].reverse();
---

<Layout title={`Projects | ${SITE.title}`}>
  <Header activeNav="posts" />
  <Main pageTitle="Projects" pageDesc="All Stupid Stuff I made.">
    <ul>
      {
        sortedProjects && sortedProjects.length > 0 ? (
          sortedProjects.map((project) => (
            <Card 
              href={project.link} 
              frontmatter={{
                title: project.title,
                description: project.description,
                technologies: project.technologies
              }} 
            />
          ))
        ) : (
          <p>No projects found. Check console for logs.</p>
        )
      }
    </ul>
  </Main>

  <Footer noMarginTop={false} />
</Layout>